<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A highly abstracted plot that can be used to plot an average value within and across experiments. This
is useful for examining features of synaptic events, e.g. amplitude, failure rate, potency, paired-pulse ratio.
The plot requires pre-processing of the feature(s) of interest and a column with unique values to group by, i.e.
experiment recording IDs."><title>Plot Event Value (Average) — plot_event_avg • matools</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Event Value (Average) — plot_event_avg"><meta property="og:description" content="A highly abstracted plot that can be used to plot an average value within and across experiments. This
is useful for examining features of synaptic events, e.g. amplitude, failure rate, potency, paired-pulse ratio.
The plot requires pre-processing of the feature(s) of interest and a column with unique values to group by, i.e.
experiment recording IDs."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">matools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/workflow_evoked_ap.html">Example Workflow: Evoked Action Potentials</a>
    <a class="dropdown-item" href="../articles/workflow_evoked_psp.html">Example Workflow: Evoked Postsynaptic Potentials (or Currents)</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/trfore/matools/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plot Event Value (Average)</h1>
      <small class="dont-index">Source: <a href="https://github.com/trfore/matools/blob/HEAD/R/plot_event_avg.R" class="external-link"><code>R/plot_event_avg.R</code></a></small>
      <div class="d-none name"><code>plot_event_avg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A highly abstracted plot that can be used to plot an average value within and across experiments. This
is useful for examining features of synaptic events, e.g. amplitude, failure rate, potency, paired-pulse ratio.
The plot requires pre-processing of the feature(s) of interest and a column with unique values to group by, i.e.
experiment recording IDs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_event_avg</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  <span class="va">x_axis</span>,</span>
<span>  <span class="va">y_axis</span>,</span>
<span>  <span class="va">plot_grouping</span>,</span>
<span>  plot_mean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  weighted_mean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sd_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  experiment_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x_label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_label <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ymax <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>df</dt>
<dd><p>Data frame or Tibble, grouped experiment data set.</p></dd>


<dt>x_axis</dt>
<dd><p>Character - unquoted, non-standard evaluation. Column name to use for x-axis.</p></dd>


<dt>y_axis</dt>
<dd><p>Character - unquoted, non-standard evaluation. Column name to use for y-axis.</p></dd>


<dt>plot_grouping</dt>
<dd><p>Character, column name to use for grouping.</p></dd>


<dt>plot_mean</dt>
<dd><p>Boolean, add group mean to plot. Default is <code>FALSE</code>.</p></dd>


<dt>weighted_mean</dt>
<dd><p>Boolean, plot weighted mean, requires df column labelled <code>'w'</code> of weights \(w\).
Default is <code>FALSE</code>.</p></dd>


<dt>sd_value</dt>
<dd><p>Optional character, std deviation measurement to use, accepts "sd" or "sem". Default is <code>NULL</code>.</p></dd>


<dt>experiment_name</dt>
<dd><p>Optional character, add a subtitle with experiment name. Default is <code>NULL</code>.</p></dd>


<dt>x_label</dt>
<dd><p>Optional character, custom label for x-axis. Default <code>NULL</code>, will use the x_axis column name.</p></dd>


<dt>y_label</dt>
<dd><p>Optional character, custom label for y-axis. Default <code>NULL</code>, will use the y_axis column name.</p></dd>


<dt>ymax</dt>
<dd><p>Optional integer, set a y-axis limit. Default is <code>NULL</code> and the y-axis will be automatically
determined by ggplot.</p></dd>


<dt>...</dt>
<dd><p>Optional vargs for additional ggplot function calls, e.g. <code>ylim()</code>, <code>ylab()</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A ggplot2 object with user defined features.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The weight column, <code>w</code>, is assumed to frequency weights - where a weight equals the number of occurrences.
Weighted mean and sd are calculated using the following formulas:</p><ul><li><p>weighted mean:
\(\bar{x}=\frac{\sum\limits_{i=1}^n w_i x_i}{\sum\limits_{i=1}^n w_i}\)</p></li>
<li><p>weighted sd: \(\sqrt{\hat{\sigma}^2_\mathrm{w}}\)</p></li>
<li><p>unbiased variance:
\(\hat{\sigma}^2_\mathrm{w}=\frac{\sum\limits_{i=1}^N w_i \left(x_i - \mu^{*}\right)^2 }{\sum_{i=1}^N w_i - 1}\)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    
<ul><li><p><a href="https://en.wikipedia.org/wiki/weighted_arithmetic_mean" class="external-link">Wikipedia: Weighted arithmetic mean</a></p></li>
<li><p><a href="https://github.com/harrelfe/Hmisc/issues/22#issuecomment-94307602" class="external-link">GitHub: harrelfe/Hmisc - issues #22</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="https://rdrr.io/r/stats/weighted.mean.html" class="external-link">stats::weighted.mean()</a></code></p></li>
<li><p><code><a href="https://rdrr.io/pkg/Hmisc/man/wtd.stats.html" class="external-link">Hmisc::wtd.var()</a></code></p></li>
</ul></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">simple_tbl</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    recording_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    experiment_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"example"</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"drug_1"</span>, <span class="st">"drug_2"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    amplitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_event_avg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">simple_tbl</span>,</span></span>
<span class="r-in"><span>  x_axis <span class="op">=</span> <span class="va">condition</span>,</span></span>
<span class="r-in"><span>  y_axis <span class="op">=</span> <span class="va">amplitude</span>,</span></span>
<span class="r-in"><span>  plot_grouping <span class="op">=</span> <span class="st">"recording_id"</span>,</span></span>
<span class="r-in"><span>  plot_mean <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  sd_value <span class="op">=</span> <span class="st">"sem"</span>,</span></span>
<span class="r-in"><span>  experiment_name <span class="op">=</span> <span class="st">"example"</span>,</span></span>
<span class="r-in"><span>  ymax <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_event_avg-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># remove average and add custom labels</span></span></span>
<span class="r-in"><span><span class="fu">plot_event_avg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">simple_tbl</span>,</span></span>
<span class="r-in"><span>  x_axis <span class="op">=</span> <span class="va">condition</span>,</span></span>
<span class="r-in"><span>  y_axis <span class="op">=</span> <span class="va">amplitude</span>,</span></span>
<span class="r-in"><span>  plot_grouping <span class="op">=</span> <span class="st">"recording_id"</span>,</span></span>
<span class="r-in"><span>  plot_mean <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  experiment_name <span class="op">=</span> <span class="st">"example"</span>,</span></span>
<span class="r-in"><span>  x_label <span class="op">=</span> <span class="st">"custom x-label"</span>,</span></span>
<span class="r-in"><span>  y_label <span class="op">=</span> <span class="st">"custom y-label"</span>,</span></span>
<span class="r-in"><span>  ymax <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_event_avg-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot a weighted average</span></span></span>
<span class="r-in"><span><span class="va">weighted_tbl</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    recording_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    experiment_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"example"</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"drug_1"</span>, <span class="st">"drug_2"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    amplitude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    w <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_event_avg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">weighted_tbl</span>,</span></span>
<span class="r-in"><span>  x_axis <span class="op">=</span> <span class="va">condition</span>,</span></span>
<span class="r-in"><span>  y_axis <span class="op">=</span> <span class="va">amplitude</span>,</span></span>
<span class="r-in"><span>  plot_grouping <span class="op">=</span> <span class="st">"recording_id"</span>,</span></span>
<span class="r-in"><span>  plot_mean <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  weighted_mean <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  sd_value <span class="op">=</span> <span class="st">"sd"</span>,</span></span>
<span class="r-in"><span>  experiment_name <span class="op">=</span> <span class="st">"plot weighted mean"</span>,</span></span>
<span class="r-in"><span>  x_label <span class="op">=</span> <span class="st">"condition"</span>,</span></span>
<span class="r-in"><span>  y_label <span class="op">=</span> <span class="st">"amplitude"</span>,</span></span>
<span class="r-in"><span>  ymax <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_event_avg-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

